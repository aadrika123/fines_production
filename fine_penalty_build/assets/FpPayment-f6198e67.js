import{u as Q,a as G,r as i,j as e}from"./index-39173d9b.js";import{P as Y}from"./ProjectApiList-1758d190.js";import{A as I}from"./ApiHeader-6d683756.js";import{B as z}from"./BarLoader-24059041.js";import{C as le,B as J}from"./BottomErrorCard-fcc57bc1.js";import{d as C,k as F,j as se,a as oe,n as N,i as ne}from"./PowerupFunctions-41fa6459.js";import{A as E}from"./AxiosInterceptors-c8c6cb85.js";import{c as re,a as b,u as de}from"./formik.esm-f89f70e4.js";import{M as ie}from"./index-eb057e92.js";import{F as ce}from"./index.esm-fdc99299.js";import{a as me}from"./index.esm-dc062bd4.js";import{_ as ue}from"./index-799c7014.js";import{u as xe}from"./useSetTitle-1a58b40d.js";import"./index-387d7a00.js";import"./iconBase-44c8784f.js";const he={content:{top:"50%",left:"50%",right:"auto",bottom:"auto",marginRight:"-50%",transform:"translate(-50%, -50%)",backgroundColor:"white",border:"none"}};function be(r){var O,L,B,V;const{id:u}=Q(),{api_challanOfflinePayment:f}=Y(),g=G(),[w,a]=i.useState(!1),[P,m]=i.useState(!1),[S,v]=i.useState(!1),[M,x]=i.useState(!1),[q,o]=i.useState(null),[h,k]=i.useState(null),[_,p]=i.useState(!1),[A,K]=i.useState(),W=`upi://pay?pa=your-vpa@provider&pn=MerchantName&mc=1234&tid=1234567890&tr=order-id&tn=Payment%20Description&am=${(O=r==null?void 0:r.demand)==null?void 0:O.total_payable_amount}&cu=INR`;let X=re({paymentMode:b().required("select payment mode"),remarks:b(),bankName:b(),branchName:b(),cheque_dd_no:b(),cheque_dd_date:b()});const t=de({initialValues:{paymentMode:"CASH",remarks:"",bankName:"",branchName:"",cheque_dd_no:"",cheque_dd_date:"",payAdvance:"",advanceAmount:""},validationSchema:X,onSubmit:l=>{console.log("values at submit payment",l),ee(l)&&((l==null?void 0:l.paymentMode)=="ONLINE"?D():x(!0))}}),c=(l,d)=>{k(d),v(l)},Z=l=>{let d=l.target.name,s=l.target.value;d=="paymentMode"&&K(s),d=="remarks"&&t.setFieldValue("remarks",F(s,t.values.remarks,100)),d=="bankName"&&t.setFieldValue("bankName",F(s,t.values.bankName,100)),d=="branchName"&&t.setFieldValue("branchName",F(s,t.values.branchName,100)),d=="cheque_dd_no"&&t.setFieldValue("cheque_dd_no",se(s,t.values.cheque_dd_no,20)),d=="advanceAmount"&&t.setFieldValue("advanceAmount",oe(s,t.values.advanceAmount,10))},R=()=>x(!1),ee=l=>{if(console.log("vlaues at ruleset..",l),l.paymentMode=="CHEQUE"||l.paymentMode=="DD"){if(l.bankName==""||l.bankName==null)return c(!0,"Please enter bank name"),!1;if(l.branchName==""||l.branchName==null)return c(!0,"Please enter branch name"),!1;if(l.cheque_dd_no==""||l.cheque_dd_no==null)return c(!0,"Please enter cheque/dd no."),!1;if(l.cheque_dd_date==""||l.cheque_dd_date==null)return c(!0,"Please enter cheque/dd date"),!1}return!0},te=async()=>{m(!0);let l,d;l="",d={applicationId:u},console.log("before get order id...",d),E.post(l,d,I()).then(s=>{var y,n,j;console.log("Order Id Response ",s==null?void 0:s.data),((y=s==null?void 0:s.data)==null?void 0:y.status)===!0?(console.log("OrderId Generated True",(n=s==null?void 0:s.data)==null?void 0:n.data),p(!0)):c(!0,(j=s==null?void 0:s.data)==null?void 0:j.message),m(!1)}).catch(s=>{console.log("ERROR :-  Unable to Generate Order Id ",s),m(!1),c(!0,"Unable to generate order id")})},ae=l=>{var y;v(!1),m(!0);let d,s;d=f,s={applicationId:(y=r==null?void 0:r.demand)==null?void 0:y.application_id,challanId:u,paymentMode:l==null?void 0:l.paymentMode},console.log("before make payment..",s),E.post(d,s,I()).then(function(n){var j,$,T,U,H;console.log("fine and penalty payment response...",n==null?void 0:n.data),(j=n==null?void 0:n.data)!=null&&j.status?(o((T=($=n==null?void 0:n.data)==null?void 0:$.data)==null?void 0:T.tran_no),a((U=n==null?void 0:n.data)==null?void 0:U.status)):c(!0,(H=n==null?void 0:n.data)==null?void 0:H.message),m(!1)}).catch(function(n){console.log("fine and penalty payment error..",n),c(!0,"Error occured. Please try again later."),m(!1)})},D=()=>{var l;x(!1),((l=t.values)==null?void 0:l.paymentMode)=="ONLINE"?te():ae(t.values)};return P?e.jsx(e.Fragment,{children:e.jsx(z,{})}):w==!0?e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"Your payment has been successfully done !"}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("button",{className:"mr-4 bg-indigo-500  text-white px-6 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>g(`/fp-receipt/${encodeURIComponent(q)}`),children:"View Receipt"}),e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>g(`/challan/${u}`),children:"View Challan"})]})]})})}):_?e.jsx(le,{children:e.jsxs("div",{className:"relative bg-white w-[90vw] md:w-[50vw] h-[80vh] md:h-[35vw] py-8 gap-8 border rounded-md shadow-lg shadow-indigo-50 border-indigo-600 flex flex-col justify-center items-center",children:[e.jsx("button",{className:"absolute top-4 right-4 font-bold bg-red-200 p-2 rounded-full shadow-sm hover:bg-red-400",onClick:()=>p(!1),children:e.jsx(me,{})}),e.jsx("div",{className:"flex justify-center",children:e.jsx("span",{className:"font-semibold border-b text-xl uppercase",children:"Scan To Pay"})}),e.jsx(ue,{value:W}),e.jsx("div",{className:" font-semibold bg-green-300 px-8 py-1.5 rounded-sm",children:C((L=r==null?void 0:r.demand)==null?void 0:L.total_payable_amount)})]})}):e.jsxs(e.Fragment,{children:[S&&e.jsx(J,{activateBottomErrorCard:c,errorTitle:h}),e.jsx("div",{className:" block sm:p-4 mt-4 w-full md:py-4 md:px-40 md:pb-0 md:pt-0 rounded-lg shadow-lg bg-white md:w-full mx-auto  overflow-x-auto mb-20 ",children:e.jsx("div",{className:" block p-4 w-full md:py-6 rounded-lg bg-white mx-auto ",children:e.jsxs("form",{onSubmit:t.handleSubmit,onChange:Z,className:"p-4 relative",children:[e.jsxs("div",{className:"grid grid-cols-12",children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Payment Mode"]}),e.jsx("select",{...t.getFieldProps("paymentMode"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",children:e.jsx("option",{value:"CASH",children:"Cash"})}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:t.touched.paymentMode&&t.errors.paymentMode?t.errors.paymentMode:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsx("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:"Remarks"}),e.jsx("input",{...t.getFieldProps("remarks"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Remarks"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:t.touched.remarks&&t.errors.remarks?t.errors.remarks:null})]}),(A=="CHEQUE"||A=="DD")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Bank Name"]}),e.jsx("input",{...t.getFieldProps("bankName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Bank Name"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:t.touched.bankName&&t.errors.bankName?t.errors.bankName:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Branch Name"]}),e.jsx("input",{...t.getFieldProps("branchName"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Branch Name"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:t.touched.branchName&&t.errors.branchName?t.errors.branchName:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD No"]}),e.jsx("input",{...t.getFieldProps("cheque_dd_no"),type:"text",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md",placeholder:"Enter Cheque/DD No"}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:t.touched.cheque_dd_no&&t.errors.cheque_dd_no?t.errors.cheque_dd_no:null})]}),e.jsxs("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:[e.jsxs("label",{className:"form-label inline-block mb-1 text-gray-600 text-sm font-semibold",children:[e.jsx("small",{className:" mt-1 text-sm font-semibold text-red-600 inline ",children:"*"}),"Cheque/DD Date"]}),e.jsx("input",{...t.getFieldProps("cheque_dd_date"),type:"date",className:"form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-blue-600 focus:outline-none placeholder-gray-300 shadow-md cursor-pointer",placeholder:"Enter new ward no."}),e.jsx("span",{className:"text-red-600 absolute text-xs",children:t.touched.cheque_dd_date&&t.errors.cheque_dd_date?t.errors.cheque_dd_date:null})]})]}),e.jsx("div",{className:"col-span-12"}),e.jsx("div",{className:"form-group mb-6 col-span-12 md:col-span-6 md:px-4",children:e.jsxs("div",{className:"w-2/3",children:[e.jsx("span",{children:"Total Payable Amount :"})," ",e.jsx("span",{className:"font-mono font-semibold text-xl",children:C((B=r==null?void 0:r.demand)==null?void 0:B.amount)})]})})]}),e.jsxs("div",{className:"col-span-12 grid grid-cols-2 sm:mt-10 mt-6",children:[e.jsx("div",{className:""}),e.jsx("div",{className:"md:pl-10 text-right",children:t.values.paymentMode!="ONLINE"?e.jsxs("button",{type:"submit",className:"sm:ml-4 font-bold sm:px-6 px-1.5 py-2 bg-indigo-500 text-white text-xs sm:text-sm leading-tight uppercase rounded  hover:bg-indigo-700 hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out shadow-xl border border-white",children:[e.jsx("span",{className:"sm:mr-2 mr-1",children:"Pay "}),C((V=r==null?void 0:r.demand)==null?void 0:V.amount)]}):e.jsx("button",{type:"submit",className:"sm:ml-4 font-bold sm:px-6 px-1.5 py-2 bg-indigo-500 text-white text-xs sm:text-sm leading-tight uppercase rounded  hover:bg-indigo-700 hover:shadow-lg focus:shadow-lg focus:outline-none focus:ring-0 active:bg-indigo-800 active:shadow-lg transition duration-150 ease-in-out shadow-xl border border-white",children:e.jsx("span",{className:"sm:mr-2 mr-1",children:"Genrate QR"})})})]})]})})}),e.jsx(ie,{isOpen:M,onRequestClose:R,style:he,contentLabel:"Example Modal",children:e.jsxs("div",{class:"relative bg-white rounded-lg shadow-xl border-2 border-gray-50",children:[e.jsx("button",{onClick:R,type:"button",class:"absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white",children:e.jsx("svg",{class:"w-5 h-5",fill:"currentColor",children:e.jsx("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})})}),e.jsxs("div",{class:"p-6 text-center",children:[e.jsxs("div",{className:"w-full flex h-10",children:[" ",e.jsx("span",{className:"mx-auto",children:e.jsx(ce,{size:30})})]}),e.jsx("h3",{class:"mb-5 text-lg font-normal text-gray-500 dark:text-gray-400",children:"Confirm Payment"}),e.jsx("button",{type:"button",class:"text-white bg-green-600 hover:bg-green-800 focus:ring-4 focus:outline-none focus:ring-red-300 dark:focus:ring-red-800 font-medium rounded-lg text-sm inline-flex items-center px-5 py-2.5 text-center mr-2",onClick:D,children:"Yes, I'm sure"})]})]})})]})}const Fe=()=>{xe("Fines & Penalties Payment");const{api_getChallanById:r}=Y(),{id:u}=Q(),f=G(),[g,w]=i.useState(!1),[a,P]=i.useState(null),[m,S]=i.useState(!1),[v,M]=i.useState(""),x=(o,h)=>{M(h),S(o),o||window.history.back()},q=()=>{w(!0),E.post(r,{challanId:u},I()).then(o=>{var h,k,_,p;console.log("getting response of user data => ",o),(h=o==null?void 0:o.data)!=null&&h.status?(console.log("user data => ",(k=o==null?void 0:o.data)==null?void 0:k.data),P((_=o==null?void 0:o.data)==null?void 0:_.data)):x(!0,(p=o==null?void 0:o.data)==null?void 0:p.message)}).catch(o=>{console.log("getting error user details marriage => ",o),x(!0,"Error getting user details, please try again later !")}).finally(()=>{w(!1)})};return i.useEffect(()=>{q()},[]),e.jsxs(e.Fragment,{children:[g&&e.jsx(z,{}),m&&e.jsx(J,{activateBottomErrorCard:x,errorTitle:v}),!g&&e.jsxs("div",{className:"animate__animated animate__fadeIn animate__faster overflow-x-hidden overflow-y-scroll w-[99%] mx-auto rounded-md gap-6 h-full p-[1vw]",children:[e.jsx("div",{className:"flex justify-center mb-6",children:e.jsx("h1",{className:"bg-white shadow-lg shadow-indigo-300 text-indigo-400 w-max font-semibold text-2xl px-6 py-2 border border-indigo-400",children:"Fines & Penalties Payment"})}),e.jsxs("div",{className:"flex items-center flex-wrap w-full text-sm bg-white p-4 shadow-lg gap-2 mt-4",children:[e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[27%]",children:[e.jsx("div",{children:"Name"}),e.jsx("div",{className:"font-semibold text-base",children:N(a==null?void 0:a.full_name)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Mobile No."}),e.jsx("div",{className:"font-semibold text-base",children:N(a==null?void 0:a.mobile)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Challan No. "}),e.jsx("div",{className:"font-semibold text-base",children:N(a==null?void 0:a.challan_no)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Challan Date "}),e.jsx("div",{className:"font-semibold text-base",children:ne(a==null?void 0:a.challan_date)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full",children:[e.jsx("div",{children:"Violation Made "}),e.jsx("div",{className:"font-semibold text-base",children:N(a==null?void 0:a.violation_name)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Violation Section "}),e.jsx("div",{className:"font-semibold text-base",children:N(a==null?void 0:a.violation_section)})]}),e.jsxs("div",{className:"flex flex-col flex-wrap justify-center w-full md:w-[22%]",children:[e.jsx("div",{children:"Penalty Amount "}),e.jsx("div",{className:"font-semibold text-base",children:C(a==null?void 0:a.amount)})]})]}),e.jsx("div",{children:a!=null&&a.is_bpl?e.jsx(e.Fragment,{children:e.jsx("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"As you belongs to BPL category, so you don't need to pay. And your application is sent for verification."}),e.jsx("div",{className:"text-center mt-6",children:e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>f(`/fp-details/${u}`),children:"View Application"})})]})})}):e.jsx(e.Fragment,{children:a!=null&&a.payment_status?e.jsx("div",{className:"w-full h-full bg-white sm:p-20 p-2",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-center font-semibold text-3xl",children:"Payment Already Done. You can view your receipt or challan."}),e.jsxs("div",{className:"text-center mt-6",children:[e.jsx("button",{className:"mr-4 bg-indigo-500  text-white px-6 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>f(`/fp-receipt/${encodeURIComponent(a==null?void 0:a.tran_no)}`),children:"View Receipt"}),e.jsx("button",{className:"mr-4 bg-white border border-indigo-500 text-indigo-500 px-4 py-1 shadow-lg hover:scale-105 rounded-sm",onClick:()=>f(`/challan/${u}`),children:"View Challan"})]})]})}):e.jsx(be,{demand:a})})})]})]})};export{Fe as default};
