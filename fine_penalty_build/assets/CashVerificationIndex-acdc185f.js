import{a as is,r as n,j as e,n as os}from"./index-09fb20e5.js";import"./index-dabe3372.js";import{A as _}from"./ApiHeader-6d683756.js";import{S as P}from"./ShimmerEffectInline-81eae6df.js";import{c as ns,a as ls,u as cs}from"./formik.esm-e2b7289d.js";import{R as ds}from"./index.esm-2628dbe5.js";import{R as hs}from"./Hourglass-04fbe6a1.js";import{P as xs}from"./ProjectApiList-38ebe721.js";import{g as H,n as j,d as A,i as fs,c as k}from"./PowerupFunctions-972dbaa1.js";import{u as ps}from"./useSetTitle-dc668ca5.js";import{F as us}from"./index.esm-b8921ec1.js";import{B as ms}from"./BottomErrorCard-1cad5fbc.js";import{A as E}from"./AxiosInterceptors-c9687ad8.js";import{R as gs}from"./index.esm-f17435a0.js";import{L as bs}from"./ListTable-3a23dc3b.js";import"./index-387d7a00.js";import"./iconBase-808696e5.js";import"./index-966ba417.js";import"./index.esm-b5c33ff4.js";const Hs=()=>{var z,V,B;ps("Cash Verification");const{api_cashVerificaionList:M,api_cashVerificaionById:L,api_verifyCash:$}=xs();is();const m=n.useRef(),q=[{Header:"Sl.No.",Cell:({row:s})=>e.jsx("div",{children:(s==null?void 0:s.index)+1})},{Header:"Officer Name",accessor:"officer_name",Cell:({cell:s})=>{var t;return j((t=s.row.original)==null?void 0:t.officer_name)}},{Header:"Mobile No.",accessor:"mobile",Cell:({cell:s})=>{var t;return j((t=s.row.original)==null?void 0:t.mobile)}},{Header:"Total Amount",accessor:"penalty_amount",Cell:({cell:s})=>{var t;return A((t=s.row.original)==null?void 0:t.penalty_amount)}},{Header:"Action",accessor:"id",Cell:({cell:s})=>e.jsx("div",{className:"flex items-center flex-wrap flex-row gap-1",children:e.jsx("button",{onClick:()=>{var t;return es((t=s==null?void 0:s.row)==null?void 0:t.original)},className:Y,children:"View"})})}];n.useState({}),n.useState(0);const[N,I]=n.useState(!1),[a,O]=n.useState(null),[G,W]=n.useState(""),[J,K]=n.useState(!1),[x,g]=n.useState([]),[d,Q]=n.useState([]),[w,C]=n.useState(!1),[b,v]=n.useState(!1),[i,U]=n.useState(null),X="text-gray-800 text-sm",F="border focus:outline-none drop-shadow-sm focus:drop-shadow-md px-4 py-1 text-gray-700 shadow-black placeholder:text-sm focus:outline-none",Y="border border-sky-800 text-sky-800 mx-1 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-sky-800 hover:text-white focus:outline-none",y=[{title:"Date",key:"date",width:"md:w-[20%] w-full",type:"date",hint:"",required:!0,options:"",okey:"",ovalue:""}],Z=(s,t="",r,o="",l="",c=!1,h=[],u="",as="")=>e.jsxs("div",{className:`flex flex-col ${o} `,children:[t!=""&&e.jsxs("label",{htmlFor:s,className:X,children:[t," ",c&&e.jsx("span",{className:"text-red-500 text-xs font-bold",children:"*"})," : "]}),r!="select"&&r!="file"&&e.jsx("input",{...f.getFieldProps(s),type:r,className:F+` ${f.touched[s]&&f.errors[s]?" border-red-200 placeholder:text-red-400 ":" focus:border-zinc-300 border-zinc-200"}`,name:s,id:"",placeholder:l}),r=="select"&&e.jsxs("select",{...f.getFieldProps(s),className:F+` ${f.touched[s]&&f.errors[s]?" border-red-200 placeholder:text-red-400 text-red-400":" focus:border-zinc-300 border-zinc-200 "}`,children:[e.jsx("option",{value:"",children:"All"}),h==null?void 0:h.map(T=>e.jsx("option",{className:"",value:T[u],children:T[as]}))]})]}),D=ns().shape([...y].reduce((s,t)=>(t!=null&&t.required&&(s[t.key]=ls().required(t==null?void 0:t.hint)),s),{})),ss={date:H()},f=cs({initialValues:ss,enableReinitialize:!0,validationSchema:D,onSubmit:s=>{S(s)}}),p=(s,t)=>{K(s),W(t)},S=s=>{I(!0);let t={date:s==null?void 0:s.date};E.post(M,t,_()).then(r=>{var o,l,c;(o=r==null?void 0:r.data)!=null&&o.status?Q((l=r==null?void 0:r.data)==null?void 0:l.data):p(!0,k((c=r==null?void 0:r.data)==null?void 0:c.message)),console.log("fp cash verification list response => ",r)}).catch(r=>{p(!0,"Server Error! Please try again later."),console.log("error fp cash verification list => ",r)}).finally(()=>{I(!1)})};n.useEffect(()=>{S({date:H()})},[]);const es=s=>{U(s),v(!0),m.current.showModal();let t={date:s==null?void 0:s.date,userId:s==null?void 0:s.user_id};E.post(L,t,_()).then(r=>{var o,l,c;(o=r==null?void 0:r.data)!=null&&o.status?O((l=r==null?void 0:r.data)==null?void 0:l.data):(p(!0,k((c=r==null?void 0:r.data)==null?void 0:c.message)),m.current.close()),console.log("fp cash verification list response => ",r)}).catch(r=>{p(!0,"Server Error! Please try again later."),console.log("error fp cash verification list => ",r),m.current.close()}).finally(()=>{v(!1)})},ts=s=>x.some(t=>parseInt(t)==parseInt(s)),R=(s,t="")=>{var c;const r=s.target.name,o=s.target.value,l=s.target.checked;if(r=="cashAll")if(C(l),l){const h=(c=a==null?void 0:a.tranDtl)==null?void 0:c.map(u=>u==null?void 0:u.id);g(h)}else g([]);if(r=="cashSingle"){if(l)g(h=>[...h,o]);else if(!l&&w!=!0){let h=x==null?void 0:x.filter(u=>u!=o);g(h)}}},rs=()=>{if((x==null?void 0:x.length)==0)return;v(!0);let s={id:x,tcId:a==null?void 0:a.tcId,date:a==null?void 0:a.date};E.post($,s,_()).then(t=>{var r,o;(r=t==null?void 0:t.data)!=null&&r.status?(os.success("Cash Verified Successfully !!!"),S({date:a==null?void 0:a.date})):p(!0,k((o=t==null?void 0:t.data)==null?void 0:o.message)),console.log("fp cash verification response => ",t)}).catch(t=>{p(!0,"Server Error! Please try again later."),console.log("error fp cash verification => ",t)}).finally(()=>{v(!1),m.current.close(),C(!1),g([])})};return e.jsxs(e.Fragment,{children:[J&&e.jsx(ms,{activateBottomErrorCard:p,errorTitle:G}),e.jsxs("form",{onSubmit:f.handleSubmit,onChange:f.handleChange,className:"bg-white poppins p-4 mb-8",children:[e.jsx("h1",{className:"text-xl font-semibold uppercase text-center text-gray-700 border-b border-gray-400 mb-4 pb-1",children:"Cash Verification"}),e.jsxs("section",{className:"flex gap-4 flex-wrap my-6",children:[y==null?void 0:y.map(s=>Z(s==null?void 0:s.key,s==null?void 0:s.title,s==null?void 0:s.type,s==null?void 0:s.width,s==null?void 0:s.hint,s==null?void 0:s.required,s==null?void 0:s.options,s==null?void 0:s.okey,s==null?void 0:s.ovalue)),e.jsx("div",{className:"mt-4 w-full md:w-[30%] flex flex-row flex-wrap items-center gap-x-4 gap-y-2 md:mt-4",children:e.jsx("div",{className:" ",children:N?e.jsx(e.Fragment,{children:e.jsx("div",{className:"flex justify-center",children:e.jsx(hs,{strokeColor:"grey",strokeWidth:"5",animationDuration:"0.75",width:"25",visible:!0})})}):e.jsxs("button",{type:"submit",className:" flex items-center border border-green-600 bg-green-500 hover:bg-green-600 text-white shadow-md rounded-sm  text-sm px-5 py-1",children:[e.jsx("span",{className:"",children:e.jsx(ds,{fontSize:""})}),e.jsx("span",{children:"Search Record"})]})})})]})]}),e.jsxs("dialog",{ref:m,className:"relative overflow-clip animate__animated animate__zoomIn animate__faster focus:outline-none backdrop:backdrop-brightness-75",children:[!N&&e.jsx("span",{onClick:()=>(m.current.close(),g([]),C(!1)),className:"block p-1 bg-red-100 hover:bg-red-500 rounded-full hover:text-white cursor-pointer transition-all duration-200 absolute top-2 right-2",children:e.jsx(gs,{})}),e.jsx("div",{className:" z-50 px-6 py-4 flex flex-col gap-4 ",children:e.jsxs("div",{className:"flex flex-col items-between justify-center",children:[e.jsxs("div",{className:"w-full flex flex-col items-center mb-4 pb-2 border-b",children:[e.jsx("span",{className:"text-green-500 p-2 block rounded-full drop-shadow-md shadow-green-300",children:e.jsx(us,{size:25})}),e.jsxs("span",{className:"font-semibold",children:[i==null?void 0:i.officer_name," Cash Collection Details"]})]}),e.jsxs("div",{className:"grid grid-cols-12 items-center gap-x-4 gap-y-2 text-sm",children:[e.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[e.jsx("div",{className:"col-span-6 font-semibold",children:"Officer Name: "}),e.jsx("div",{className:"col-span-6",children:j(i==null?void 0:i.officer_name)})]}),e.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[e.jsx("div",{className:"col-span-6 font-semibold",children:"Mobile No.: "}),e.jsx("div",{className:"col-span-6",children:j(i==null?void 0:i.mobile)})]}),e.jsxs("div",{className:"col-span-12 md:col-span-6 grid grid-cols-12 items-center gap-x-1",children:[e.jsx("div",{className:"col-span-6 font-semibold",children:"Total Amount: "}),e.jsx("div",{className:"col-span-6",children:A(i==null?void 0:i.penalty_amount)})]})]}),e.jsxs("div",{className:"w-full mt-4 mb-2",children:[e.jsxs("div",{className:"font-semibold ",children:[e.jsxs("span",{children:["Collection List (Date : ",i==null?void 0:i.date,")"]}),!b&&Array.isArray(a==null?void 0:a.tranDtl)&&((z=a==null?void 0:a.tranDtl)==null?void 0:z.length)>0&&e.jsx("button",{onClick:()=>rs(),className:"font-normal text-sm float-right bg-green-500 px-3 py-1 rounded-sm shadow-lg hover:shadow-xl hover:bg-green-600 hover:text-white text-white flex items-center mb-1",children:"Verify"})]}),e.jsxs("div",{className:"flex flex-col h-[60vh] w-full overflow-y-auto md:overflow-x-hidden",children:[e.jsxs("div",{className:"w-full grid grid-cols-12 items-center gap-2 bg-slate-500 text-white font-semibold border border-slate-200 px-4 py-2",children:[e.jsx("div",{className:"col-span-2 text-sm",children:"Sl.No."}),e.jsx("div",{className:"col-span-3 text-sm",children:"Transaction No"}),e.jsx("div",{className:"col-span-3 text-sm",children:"Transaction Date"}),e.jsx("div",{className:"col-span-2 text-sm",children:"Amount"}),e.jsxs("div",{className:"col-span-2 text-sm flex",children:[e.jsx("span",{children:"Action"}),!b&&Array.isArray(a==null?void 0:a.tranDtl)&&((V=a==null?void 0:a.tranDtl)==null?void 0:V.length)>0&&e.jsx("label",{class:"inline-flex items-center px-4 animate__animated animate__fadeIn animate__faster",children:e.jsx("input",{type:"checkbox",name:"cashAll",checked:w,onChange:s=>R(s),class:"cursor-pointer form-checkbox h-5 w-5 text-slate-800"})})]})]}),b&&e.jsx(P,{}),!b&&Array.isArray(a==null?void 0:a.tranDtl)&&((B=a==null?void 0:a.tranDtl)==null?void 0:B.map((s,t)=>e.jsx(e.Fragment,{children:e.jsxs("div",{className:"w-full text-sm grid grid-cols-12 items-center gap-2 bg-slate-100 border-b hover:bg-white pb-1 p-4 animate__animated animate__fadeIn animate__faster",children:[e.jsx("div",{className:"col-span-2",children:t+1}),e.jsx("div",{className:"col-span-3",children:j(s==null?void 0:s.tran_no)}),e.jsx("div",{className:"col-span-3",children:fs(s==null?void 0:s.tran_date)}),e.jsx("div",{className:"col-span-2",children:A(s==null?void 0:s.total_amount)}),e.jsx("div",{className:"col-span-2",children:e.jsx("label",{class:"inline-flex items-center justify-end px-4",children:e.jsx("input",{type:"checkbox",name:"cashSingle",checked:w||ts(s==null?void 0:s.id)?!0:null,value:s==null?void 0:s.id,onChange:r=>R(r,s==null?void 0:s.id),class:"cursor-pointer form-checkbox h-5 w-5 text-slate-800"})})})]},t)}))),!b&&Array.isArray(d)&&(d==null?void 0:d.length)==0&&e.jsx("div",{className:"w-full text-center text-red-400 font-semibold pb-1 p-4",children:"No List Available"})]})]})]})})]}),N&&e.jsx(P,{}),!N&&Array.isArray(d)&&(d==null?void 0:d.length)>0&&e.jsx(bs,{dataList:d,columns:q})]})};export{Hs as default};
